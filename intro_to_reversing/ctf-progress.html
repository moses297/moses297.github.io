<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CTF Progress Tracker - Hackeriot 2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #ffffff;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 0;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #00ff88, #00ccff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle {
            font-size: 1.1rem;
            color: #a0a0a0;
        }

        .progress-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .hacker-title {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(45deg, #8b5cf6, #a855f7);
            border-radius: 15px;
            color: #ffffff;
        }

        .hacker-title h2 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .hacker-title p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .lesson-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .lesson-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .lesson-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .lesson-name {
            font-size: 1.3rem;
            color: #00ccff;
            font-weight: bold;
        }

        .lesson-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .status-completed {
            background: #00ff88;
            color: #1a1a2e;
        }

        .status-pending {
            background: #ff6b6b;
            color: #ffffff;
        }

        .flag-input {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .flag-input input {
            flex: 1;
            padding: 8px 12px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            font-family: 'Courier New', monospace;
        }

        .flag-input input::placeholder {
            color: #a0a0a0;
        }

        .flag-input button {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(45deg, #00ff88, #00ccff);
            color: #1a1a2e;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .flag-input button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 136, 0.3);
        }

        .flag-input button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .progress-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            border: 2px solid rgba(0, 255, 136, 0.3);
            box-shadow: 0 8px 32px rgba(0, 255, 136, 0.2);
        }

        .progress-numbers {
            text-align: left;
        }

        .progress-main {
            font-size: 3rem;
            font-weight: bold;
            color: #00ff88;
            text-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
            margin-bottom: 5px;
        }

        .progress-label {
            font-size: 1.1rem;
            color: #b0b0b0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .progress-percentage {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(45deg, #00ff88, #00ccff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(0, 255, 136, 0.3);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #00ccff);
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .progress-actions {
            text-align: center;
            margin-top: 20px;
        }

        .reset-btn {
            background: linear-gradient(45deg, #8b5cf6, #a855f7);
            color: #ffffff;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.3);
        }

        .reset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
        }

        .certificate-section {
            text-align: center;
            margin-top: 40px;
        }

        .certificate-btn {
            display: inline-block;
            background: linear-gradient(45deg, #8b5cf6, #a855f7);
            color: #ffffff;
            padding: 15px 30px;
            text-decoration: none;
            border-radius: 30px;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(139, 92, 246, 0.3);
            border: none;
            cursor: pointer;
        }

        .certificate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.4);
        }

        .certificate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .back-link {
            display: inline-block;
            margin-top: 20px;
            color: #00ccff;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s ease;
        }

        .back-link:hover {
            color: #00ff88;
        }

        .success-message {
            background: rgba(0, 255, 136, 0.2);
            border: 1px solid #00ff88;
            border-radius: 8px;
            padding: 10px;
            margin: 10px 0;
            color: #00ff88;
            text-align: center;
        }

        .error-message {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid #ff6b6b;
            border-radius: 8px;
            padding: 10px;
            margin: 10px 0;
            color: #ff6b6b;
            text-align: center;
        }

        @media (max-width: 768px) {
            .lesson-grid {
                grid-template-columns: 1fr;
            }
            
            .flag-input {
                flex-direction: column;
            }
            
            .progress-display {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
            
            .progress-main {
                font-size: 2.5rem;
            }
            
            .progress-percentage {
                font-size: 3rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>CTF Progress Tracker</h1>
            <p class="subtitle">Hackeriot 2025 - Introduction To Reverse Engineering</p>
        </header>

        <div class="progress-section">
            <div class="hacker-title" id="hackerTitle">
                <h2>Script Kiddie</h2>
                <p>Complete challenges to unlock new titles!</p>
            </div>

            <div class="progress-display">
                <div class="progress-numbers">
                    <div class="progress-main" id="progressMain">0 / 17</div>
                    <div class="progress-label">Challenges Completed</div>
                </div>
                <div class="progress-percentage" id="progressPercentage">0%</div>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            
            <div class="progress-actions">
                <button class="reset-btn" id="resetBtn" onclick="resetProgress()">
                    üîÑ Reset Progress
                </button>
            </div>
        </div>

        <div class="lesson-grid" id="lessonGrid">
            <!-- Lesson cards will be generated by JavaScript -->
        </div>

        <div class="certificate-section">
            <div style="margin-bottom: 20px;">
                <label for="userName" style="display: block; margin-bottom: 10px; color: #00ccff; font-weight: bold;">Your Name for Certificate:</label>
                <input type="text" id="userName" placeholder="Enter your name" style="padding: 10px 15px; border: none; border-radius: 8px; background: rgba(255, 255, 255, 0.1); color: #ffffff; width: 300px; font-size: 16px;">
            </div>
            <button class="certificate-btn" id="certificateBtn" disabled>
                Generate Certificate
            </button>
            <p style="margin-top: 15px; color: #b0b0b0; font-size: 0.9rem;">
                Complete all main lessons (excluding bonus) to generate your certificate
            </p>
        </div>

        <div style="text-align: center; margin-top: 40px;">
            <a href="index.html" class="back-link">‚Üê Back to Main Page</a>
        </div>
    </div>

    <script>
        // MD5 hash function (simple implementation)
        function md5(string) {
            function md5_RotateLeft(lValue, iShiftBits) {
                return (lValue << iShiftBits) | (lValue >>> (32 - iShiftBits));
            }

            function md5_AddUnsigned(lX, lY) {
                var lX4, lY4, lX8, lY8, lResult;
                lX8 = (lX & 0x80000000);
                lY8 = (lY & 0x80000000);
                lX4 = (lX & 0x40000000);
                lY4 = (lY & 0x40000000);
                lResult = (lX & 0x3FFFFFFF) + (lY & 0x3FFFFFFF);
                if (lX4 & lY4) {
                    return (lResult ^ 0x80000000 ^ lX8 ^ lY8);
                }
                if (lX4 | lY4) {
                    if (lResult & 0x40000000) {
                        return (lResult ^ 0xC0000000 ^ lX8 ^ lY8);
                    } else {
                        return (lResult ^ 0x40000000 ^ lX8 ^ lY8);
                    }
                } else {
                    return (lResult ^ lX8 ^ lY8);
                }
            }

            function md5_F(x, y, z) {
                return (x & y) | ((~x) & z);
            }

            function md5_G(x, y, z) {
                return (x & z) | (y & (~z));
            }

            function md5_H(x, y, z) {
                return (x ^ y ^ z);
            }

            function md5_I(x, y, z) {
                return (y ^ (x | (~z)));
            }

            function md5_FF(a, b, c, d, x, s, ac) {
                a = md5_AddUnsigned(a, md5_AddUnsigned(md5_AddUnsigned(md5_F(b, c, d), x), ac));
                return md5_AddUnsigned(md5_RotateLeft(a, s), b);
            }

            function md5_GG(a, b, c, d, x, s, ac) {
                a = md5_AddUnsigned(a, md5_AddUnsigned(md5_AddUnsigned(md5_G(b, c, d), x), ac));
                return md5_AddUnsigned(md5_RotateLeft(a, s), b);
            }

            function md5_HH(a, b, c, d, x, s, ac) {
                a = md5_AddUnsigned(a, md5_AddUnsigned(md5_AddUnsigned(md5_H(b, c, d), x), ac));
                return md5_AddUnsigned(md5_RotateLeft(a, s), b);
            }

            function md5_II(a, b, c, d, x, s, ac) {
                a = md5_AddUnsigned(a, md5_AddUnsigned(md5_AddUnsigned(md5_I(b, c, d), x), ac));
                return md5_AddUnsigned(md5_RotateLeft(a, s), b);
            }

            function md5_ConvertToWordArray(string) {
                var lWordCount;
                var lMessageLength = string.length;
                var lNumberOfWords_temp1 = lMessageLength + 8;
                var lNumberOfWords_temp2 = (lNumberOfWords_temp1 - (lNumberOfWords_temp1 % 64)) / 64;
                var lNumberOfWords = (lNumberOfWords_temp2 + 1) * 16;
                var lWordArray = Array(lNumberOfWords - 1);
                var lBytePosition = 0;
                var lByteCount = 0;
                while (lByteCount < lMessageLength) {
                    lWordCount = (lByteCount - (lByteCount % 4)) / 4;
                    lBytePosition = (lByteCount % 4) * 8;
                    lWordArray[lWordCount] = (lWordArray[lWordCount] | (string.charCodeAt(lByteCount) << lBytePosition));
                    lByteCount++;
                }
                lWordCount = (lByteCount - (lByteCount % 4)) / 4;
                lBytePosition = (lByteCount % 4) * 8;
                lWordArray[lWordCount] = lWordArray[lWordCount] | (0x80 << lBytePosition);
                lWordArray[lNumberOfWords - 2] = lMessageLength << 3;
                lWordArray[lNumberOfWords - 1] = lMessageLength >>> 29;
                return lWordArray;
            }

            function md5_WordToHex(lValue) {
                var WordToHexValue = "", WordToHexValue_temp = "", lByte, lCount;
                for (lCount = 0; lCount <= 3; lCount++) {
                    lByte = (lValue >>> (lCount * 8)) & 255;
                    WordToHexValue_temp = "0" + lByte.toString(16);
                    WordToHexValue = WordToHexValue + WordToHexValue_temp.substr(WordToHexValue_temp.length - 2, 2);
                }
                return WordToHexValue;
            }

            function md5_Utf8Encode(string) {
                string = string.replace(/\r\n/g, "\n");
                var utftext = "";

                for (var n = 0; n < string.length; n++) {
                    var c = string.charCodeAt(n);

                    if (c < 128) {
                        utftext += String.fromCharCode(c);
                    } else if ((c > 127) && (c < 2048)) {
                        utftext += String.fromCharCode((c >> 6) | 192);
                        utftext += String.fromCharCode((c & 63) | 128);
                    } else {
                        utftext += String.fromCharCode((c >> 12) | 224);
                        utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                        utftext += String.fromCharCode((c & 63) | 128);
                    }
                }

                return utftext;
            }

            var x = Array();
            var k, AA, BB, CC, DD, a, b, c, d;
            var S11 = 7, S12 = 12, S13 = 17, S14 = 22;
            var S21 = 5, S22 = 9, S23 = 14, S24 = 20;
            var S31 = 4, S32 = 11, S33 = 16, S34 = 23;
            var S41 = 6, S42 = 10, S43 = 15, S44 = 21;

            string = md5_Utf8Encode(string);
            x = md5_ConvertToWordArray(string);
            a = 0x67452301; b = 0xEFCDAB89; c = 0x98BADCFE; d = 0x10325476;

            for (k = 0; k < x.length; k += 16) {
                AA = a; BB = b; CC = c; DD = d;
                a = md5_FF(a, b, c, d, x[k + 0], S11, 0xD76AA478);
                d = md5_FF(d, a, b, c, x[k + 1], S12, 0xE8C7B756);
                c = md5_FF(c, d, a, b, x[k + 2], S13, 0x242070DB);
                b = md5_FF(b, c, d, a, x[k + 3], S14, 0xC1BDCEEE);
                a = md5_FF(a, b, c, d, x[k + 4], S11, 0xF57C0FAF);
                d = md5_FF(d, a, b, c, x[k + 5], S12, 0x4787C62A);
                c = md5_FF(c, d, a, b, x[k + 6], S13, 0xA8304613);
                b = md5_FF(b, c, d, a, x[k + 7], S14, 0xFD469501);
                a = md5_FF(a, b, c, d, x[k + 8], S11, 0x698098D8);
                d = md5_FF(d, a, b, c, x[k + 9], S12, 0x8B44F7AF);
                c = md5_FF(c, d, a, b, x[k + 10], S13, 0xFFFF5BB1);
                b = md5_FF(b, c, d, a, x[k + 11], S14, 0x895CD7BE);
                a = md5_FF(a, b, c, d, x[k + 12], S11, 0x6B901122);
                d = md5_FF(d, a, b, c, x[k + 13], S12, 0xFD987193);
                c = md5_FF(c, d, a, b, x[k + 14], S13, 0xA679438E);
                b = md5_FF(b, c, d, a, x[k + 15], S14, 0x49B40821);

                a = md5_GG(a, b, c, d, x[k + 1], S21, 0xF61E2562);
                d = md5_GG(d, a, b, c, x[k + 6], S22, 0xC040B340);
                c = md5_GG(c, d, a, b, x[k + 11], S23, 0x265E5A51);
                b = md5_GG(b, c, d, a, x[k + 0], S24, 0xE9B6C7AA);
                a = md5_GG(a, b, c, d, x[k + 5], S21, 0xD62F105D);
                d = md5_GG(d, a, b, c, x[k + 10], S22, 0x2441453);
                c = md5_GG(c, d, a, b, x[k + 15], S23, 0xD8A1E681);
                b = md5_GG(b, c, d, a, x[k + 4], S24, 0xE7D3FBC8);
                a = md5_GG(a, b, c, d, x[k + 9], S21, 0x21E1CDE6);
                d = md5_GG(d, a, b, c, x[k + 14], S22, 0xC33707D6);
                c = md5_GG(c, d, a, b, x[k + 3], S23, 0xF4D50D87);
                b = md5_GG(b, c, d, a, x[k + 8], S24, 0x455A14ED);
                a = md5_GG(a, b, c, d, x[k + 13], S21, 0xA9E3E905);
                d = md5_GG(d, a, b, c, x[k + 2], S22, 0xFCEFA3F8);
                c = md5_GG(c, d, a, b, x[k + 7], S23, 0x676F02D9);
                b = md5_GG(b, c, d, a, x[k + 12], S24, 0x8D2A4C8A);

                a = md5_HH(a, b, c, d, x[k + 5], S31, 0xFFFA3942);
                d = md5_HH(d, a, b, c, x[k + 8], S32, 0x8771F681);
                c = md5_HH(c, d, a, b, x[k + 11], S33, 0x6D9D6122);
                b = md5_HH(b, c, d, a, x[k + 14], S34, 0xFDE5380C);
                a = md5_HH(a, b, c, d, x[k + 1], S31, 0xA4BEEA44);
                d = md5_HH(d, a, b, c, x[k + 4], S32, 0x4BDECFA9);
                c = md5_HH(c, d, a, b, x[k + 7], S33, 0xF6BB4B60);
                b = md5_HH(b, c, d, a, x[k + 10], S34, 0xBEBFBC70);
                a = md5_HH(a, b, c, d, x[k + 13], S31, 0x289B7EC6);
                d = md5_HH(d, a, b, c, x[k + 0], S32, 0xEAA127FA);
                c = md5_HH(c, d, a, b, x[k + 3], S33, 0xD4EF3085);
                b = md5_HH(b, c, d, a, x[k + 6], S34, 0x4881D05);
                a = md5_HH(a, b, c, d, x[k + 9], S31, 0xD9D4D039);
                d = md5_HH(d, a, b, c, x[k + 12], S32, 0xE6DB99E5);
                c = md5_HH(c, d, a, b, x[k + 15], S33, 0x1FA27CF8);
                b = md5_HH(b, c, d, a, x[k + 2], S34, 0xC4AC5665);

                a = md5_II(a, b, c, d, x[k + 0], S41, 0xF4292244);
                d = md5_II(d, a, b, c, x[k + 7], S42, 0x432AFF97);
                c = md5_II(c, d, a, b, x[k + 14], S43, 0xAB9423A7);
                b = md5_II(b, c, d, a, x[k + 5], S44, 0xFC93A039);
                a = md5_II(a, b, c, d, x[k + 12], S41, 0x655B59C3);
                d = md5_II(d, a, b, c, x[k + 3], S42, 0x8F0CCC92);
                c = md5_II(c, d, a, b, x[k + 10], S43, 0xFFEFF47D);
                b = md5_II(b, c, d, a, x[k + 1], S44, 0x85845DD1);
                a = md5_II(a, b, c, d, x[k + 8], S41, 0x6FA87E4F);
                d = md5_II(d, a, b, c, x[k + 15], S42, 0xFE2CE6E0);
                c = md5_II(c, d, a, b, x[k + 6], S43, 0xA3014314);
                b = md5_II(b, c, d, a, x[k + 13], S44, 0x4E0811A1);
                a = md5_II(a, b, c, d, x[k + 4], S41, 0xF7537E82);
                d = md5_II(d, a, b, c, x[k + 11], S42, 0xBD3AF235);
                c = md5_II(c, d, a, b, x[k + 2], S43, 0x2AD7D2BB);
                b = md5_II(b, c, d, a, x[k + 9], S44, 0xEB86D391);

                a = md5_AddUnsigned(a, AA);
                b = md5_AddUnsigned(b, BB);
                c = md5_AddUnsigned(c, CC);
                d = md5_AddUnsigned(d, DD);
            }

            var temp = md5_WordToHex(a) + md5_WordToHex(b) + md5_WordToHex(c) + md5_WordToHex(d);
            return temp.toLowerCase();
        }

        // Challenge definitions with MD5 hashes
        const challenges = {
            'lesson1': [
                { id: 'baby_steps', hash: '07269f7e6e5378bcbcdd317df7815406', name: '#2' },
                { id: 'css_display_none', hash: 'b846e638cfe139c07f4fbc5bd5942ec5', name: '#3' },
                { id: 'offset_discovered', hash: '2a4b58faba26e8011e423197643356b1', name: '#4' }
            ],
            'lesson2': [
                { id: 'casino_beaten', hash: '5ea39babd14c6b5a45a6a7f0ea631060', name: 'Slots Machine' },
                { id: 'blurry_vision', hash: '5fbd3ef3bd96bc14497f6160860737e2', name: 'Blurry Vision' },
                { id: 'button_unlocked', hash: '5fd8419d2c8a1342f065aeb5d5ce7e41', name: 'Button Unlock' },
                { id: 'making_time_stop', hash: 'd2a8cba495a5dafaf5c19ee6e2b3ec95', name: 'Time Manipulation' }
            ],
            'lesson3': [
                { id: 'file_1_jpg', hash: 'c17010e9b22f8c5a8e1e6fcc6cf03bd9', name: 'File 1' },
                { id: 'file_2_png', hash: 'ab324ed5c0ebca7b6790d517d3e6093f', name: 'File 2' },
                { id: 'file_3_gif', hash: '9158a88205eb76993108e250eb35018e', name: 'File 3' },
                { id: 'file_4_pdf', hash: '46fb79c3a76a7da7a1f9e16da5459ab3', name: 'File 4' },
                { id: 'file_5_zip', hash: '57d9c267043fed402f165b9a63c5ea40', name: 'File 5' },
                { id: 'file_6_docx', hash: '16e7ce76d4ecb84e64863c4ad36a2625', name: 'File 6' },
                { id: 'header_fixer', hash: '6b458e3492e43f21c245634f29664057', name: 'Exercise #2' },
                { id: 'file_hackerit', hash: '3f613af792f5818b52f81a7d30abfdea', name: 'Exercise #3' }
            ],
            'lesson4': [
                { id: 'intro_winner', hash: '87b779c1ae67de045fb014eda134baaf', name: 'num 3' }
            ],
            'lesson5': [
                { id: 'bonus_time', hash: '33e2947b676a32ba01034387ac0b925e', name: 'keygen' }
            ]
        };

        // Hacker titles based on progress - EASY TO UPDATE!
        // Just change the threshold numbers and titles below
        const hackerTitles = [
            { threshold: 0, title: 'Script Kiddie', subtitle: 'Complete challenges to unlock new titles!' },
            { threshold: 1, title: 'Code Explorer', subtitle: 'You\'re getting the hang of this!' },
            { threshold: 2, title: 'Binary Hunter', subtitle: 'Keep digging deeper!' },
            { threshold: 3, title: 'Reverse Engineer', subtitle: 'You\'re becoming a pro!' },
            { threshold: 4, title: 'Assembly Master', subtitle: 'Impressive skills!' },
            { threshold: 5, title: 'Debug Ninja', subtitle: 'Almost there!' },
            { threshold: 6, title: 'Hex Wizard', subtitle: 'You\'re unstoppable!' },
            { threshold: 7, title: 'CTF Champion', subtitle: 'You\'ve conquered the main challenges!' },
            { threshold: 8, title: 'Binary Master', subtitle: 'Main challenges completed!' },
            { threshold: 9, title: 'File Analysis Expert', subtitle: 'You\'re a file format master!' },
            { threshold: 10, title: 'Header Hacker', subtitle: 'You\'ve mastered file headers!' },
            { threshold: 11, title: 'File Format Master', subtitle: 'You\'re unstoppable with files!' },
            { threshold: 12, title: 'PNG Fixer', subtitle: 'You can fix any corrupted file!' },
            { threshold: 13, title: 'HTML Hacker', subtitle: 'You\'ve mastered HTML manipulation!' },
            { threshold: 14, title: 'JS Manipulator', subtitle: 'You can bend JavaScript to your will!' },
            { threshold: 15, title: 'Time Controller', subtitle: 'You\'ve mastered time manipulation!' },
            { threshold: 16, title: 'UI Hacker', subtitle: 'You can unlock any interface!' },
            { threshold: 17, title: 'Reverse Engineering Master', subtitle: 'All challenges completed! You\'re a legend!' }
        ];

        // Load progress from localStorage
        let progress = {};

        // Initialize progress for all challenges
        function initializeProgress() {
            const storedProgress = localStorage.getItem('ctfProgress');
            if (storedProgress) {
                progress = JSON.parse(storedProgress);
            }
            
            Object.keys(challenges).forEach(lesson => {
                if (!progress[lesson]) {
                    progress[lesson] = {};
                }
                challenges[lesson].forEach(challenge => {
                    if (!progress[lesson][challenge.id]) {
                        progress[lesson][challenge.id] = false;
                    }
                });
            });
        }

        function saveProgress() {
            localStorage.setItem('ctfProgress', JSON.stringify(progress));
        }

        function getCompletedCount() {
            let count = 0;
            Object.keys(challenges).forEach(lesson => {
                challenges[lesson].forEach(challenge => {
                    if (progress[lesson][challenge.id]) {
                        count++;
                    }
                });
            });
            return count;
        }

        function getMainLessonCompletedCount() {
            let count = 0;
            Object.keys(challenges).forEach(lesson => {
                if (lesson !== 'lesson5') { // Exclude bonus lesson
                    challenges[lesson].forEach(challenge => {
                        if (progress[lesson][challenge.id]) {
                            count++;
                        }
                    });
                }
            });
            return count;
        }

        function updateProgress() {
            const completed = getCompletedCount();
            const mainCompleted = getMainLessonCompletedCount();
            const total = Object.values(challenges).reduce((sum, lesson) => sum + lesson.length, 0);
            const mainTotal = total - challenges.lesson5.length;

            // Calculate percentage based on completion logic
            let percentage;
            let percentageText;
            
            if (completed === total) {
                // All lessons including bonus = 1337%
                percentage = 100;
                percentageText = "1337%";
            } else if (mainCompleted === mainTotal) {
                // All main lessons completed = 100%
                percentage = 100;
                percentageText = "100%";
            } else {
                // Normal percentage calculation
                percentage = (mainCompleted / mainTotal) * 100;
                percentageText = `${Math.round(percentage)}%`;
            }
            
            // Update progress display
            const progressMain = document.getElementById('progressMain');
            const progressPercentage = document.getElementById('progressPercentage');
            const progressFill = document.getElementById('progressFill');
            
            progressMain.textContent = `${completed} / ${total}`;
            progressPercentage.textContent = percentageText;
            progressFill.style.width = percentage + '%';

            // Update hacker title (every 2 flags)
            const hackerTitle = document.getElementById('hackerTitle');
            const currentTitle = hackerTitles.slice().reverse().find(title => completed >= title.threshold);
            
            if (currentTitle) {
                hackerTitle.innerHTML = `
                    <h2>${currentTitle.title}</h2>
                    <p>${currentTitle.subtitle}</p>
                `;
            }

            // Enable/disable certificate button
            const certificateBtn = document.getElementById('certificateBtn');
            const userName = document.getElementById('userName').value.trim();
            certificateBtn.disabled = mainCompleted < mainTotal - 8 || !userName;
        }

        function createLessonCard(lessonKey, lessonName) {
            const lessonCard = document.createElement('div');
            lessonCard.className = 'lesson-card';
            
            const challengesList = challenges[lessonKey];
            const completedCount = challengesList.filter(challenge => progress[lessonKey][challenge.id]).length;
            const totalCount = challengesList.length;
            
            lessonCard.innerHTML = `
                <div class="lesson-header">
                    <div class="lesson-name">${lessonName}</div>
                    <div class="lesson-status ${completedCount === totalCount ? 'status-completed' : 'status-pending'}">
                        ${completedCount}/${totalCount}
                    </div>
                </div>
                ${challengesList.map(challenge => `
                    <div class="flag-input">
                        <input type="text" 
                               placeholder="Enter flag for: ${challenge.name}" 
                               id="input_${lessonKey}_${challenge.id}"
                               ${progress[lessonKey][challenge.id] ? 'disabled' : ''}>
                        <button onclick="submitFlag('${lessonKey}', '${challenge.id}')" 
                                id="btn_${lessonKey}_${challenge.id}"
                                ${progress[lessonKey][challenge.id] ? 'disabled' : ''}>
                            ${progress[lessonKey][challenge.id] ? 'Completed' : 'Submit'}
                        </button>
                    </div>
                `).join('')}
            `;
            
            return lessonCard;
        }

        function submitFlag(lessonKey, challengeId) {
            const input = document.getElementById(`input_${lessonKey}_${challengeId}`);
            const button = document.getElementById(`btn_${lessonKey}_${challengeId}`);
            const flag = input.value.trim();
            
            if (!flag) {
                showMessage('Please enter a flag', 'error');
                return;
            }

            const challenge = challenges[lessonKey].find(c => c.id === challengeId);
            const inputHash = md5(flag);
            
            if (inputHash === challenge.hash) {
                progress[lessonKey][challengeId] = true;
                saveProgress();
                
                input.disabled = true;
                button.disabled = true;
                button.textContent = 'Completed';
                
                updateProgress();
                showMessage('Flag accepted! Challenge completed!', 'success');
            } else {
                showMessage('Incorrect flag. Try again!', 'error');
            }
        }



        function showMessage(message, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `${type}-message`;
            messageDiv.textContent = message;
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }

        function resetProgress() {
            if (confirm('Are you sure you want to reset all progress? This action cannot be undone.')) {
                // Reset all progress
                Object.keys(challenges).forEach(lesson => {
                    challenges[lesson].forEach(challenge => {
                        progress[lesson][challenge.id] = false;
                    });
                });
                
                // Clear localStorage
                localStorage.removeItem('ctfProgress');
                
                // Reset progress object
                progress = {};
                
                // Reinitialize progress
                Object.keys(challenges).forEach(lesson => {
                    if (!progress[lesson]) {
                        progress[lesson] = {};
                    }
                    challenges[lesson].forEach(challenge => {
                        if (!progress[lesson][challenge.id]) {
                            progress[lesson][challenge.id] = false;
                        }
                    });
                });
                
                // Clear all input fields and reset UI
                Object.keys(challenges).forEach(lesson => {
                    challenges[lesson].forEach(challenge => {
                        const input = document.getElementById(`input_${lesson}_${challenge.id}`);
                        const button = document.getElementById(`btn_${lesson}_${challenge.id}`);
                        if (input && button) {
                            input.value = '';
                            input.disabled = false;
                            button.disabled = false;
                            button.textContent = 'Submit';
                        }
                    });
                });
                
                // Success messages are no longer created, so no need to remove them
                
                // Update progress display
                updateProgress();
                
                // Clear name input
                document.getElementById('userName').value = '';
                
                showMessage('Progress has been reset successfully!', 'success');
            }
        }

        function generateCertificate() {
            const userName = document.getElementById('userName').value.trim();
            if (!userName) {
                showMessage('Please enter your name for the certificate', 'error');
                return;
            }

            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = 800;
            canvas.height = 600;
            
            // Background
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, 800, 600);
            
            // Gradient border
            const gradient = ctx.createLinearGradient(0, 0, 800, 600);
            gradient.addColorStop(0, '#00ff88');
            gradient.addColorStop(1, '#00ccff');
            ctx.strokeStyle = gradient;
            ctx.lineWidth = 8;
            ctx.strokeRect(4, 4, 792, 592);
            
            // Title
            ctx.fillStyle = '#00ff88';
            ctx.font = 'bold 36px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Certificate of Completion', 400, 100);
            
            // Main text
            ctx.fillStyle = '#ffffff';
            ctx.font = '24px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('This is to certify that', 400, 180);
            
            ctx.fillStyle = '#00ccff';
            ctx.font = 'bold 28px Arial';
            ctx.fillText(userName, 400, 220);
            
            ctx.fillStyle = '#ffffff';
            ctx.font = '24px Arial';
            ctx.fillText('has successfully completed the', 400, 260);
            
            ctx.fillStyle = '#00ff88';
            ctx.font = 'bold 28px Arial';
            ctx.fillText('Introduction To Reverse Engineering', 400, 300);
            
            ctx.fillStyle = '#ffffff';
            ctx.font = '24px Arial';
            ctx.fillText('Hackeriot 2025 Workshop', 400, 340);
            
            // Date
            ctx.fillStyle = '#b0b0b0';
            ctx.font = '20px Arial';
            const today = new Date().toLocaleDateString();
            ctx.fillText(`Issued on: ${today}`, 400, 400);
            
            // Signature line
            ctx.fillStyle = '#00ccff';
            ctx.font = '18px Arial';
            ctx.fillText('Moshe Siman Tov Bustan', 400, 500);
            ctx.fillText('Hackeriot 2025', 400, 520);
            
            // Convert to image and download
            const link = document.createElement('a');
            link.download = 'hackeriot_certificate.png';
            link.href = canvas.toDataURL();
            link.click();
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize progress first
            initializeProgress();
            
            const lessonGrid = document.getElementById('lessonGrid');
            
            // Create lesson cards
            const lessonNames = {
                'lesson1': 'Lesson 1: HTML Hacking',
                'lesson2': 'Lesson 2: JavaScript Hacking',
                'lesson3': 'Lesson 3: Filetypes',
                'lesson4': 'Lesson 4: Binaries',
                'lesson5': 'Lesson 5: Bonus & MISC'
            };
            
            Object.keys(lessonNames).forEach(lessonKey => {
                const lessonCard = createLessonCard(lessonKey, lessonNames[lessonKey]);
                lessonGrid.appendChild(lessonCard);
            });
            
            // Set up certificate button
            document.getElementById('certificateBtn').addEventListener('click', generateCertificate);
            
            // Set up name input listener
            document.getElementById('userName').addEventListener('input', updateProgress);
            
            // Update progress display AFTER creating all cards
            updateProgress();
        });
    </script>
</body>
</html>